<% content_for :sidebar_active, :users %>

<% content_for :header_label, "User" %>
<% content_for :header_title, "Edit #{@user.name}" %>
<% content_for :header_subtitle, "Update identity, contact information, or reset the password." %>

<section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
  <header class="space-y-2 text-center md:text-left">
    <p class="text-xs font-semibold uppercase tracking-[0.35em] text-indigo-600">Update</p>
    <h2 class="text-xl font-semibold text-slate-900">Edit user account</h2>
    <p class="text-sm text-slate-500">Adjust user information. Leave the password fields blank to keep the current password.</p>
  </header>

  <%= form_with model: @user, class: "mt-8 grid gap-6 md:grid-cols-2" do |form| %>
    <% name_error = @user.errors.full_messages_for(:name).first %>
    <% email_error = @user.errors.full_messages_for(:email).first %>
    <% password_error = @user.errors.full_messages_for(:password).first %>
    <% password_confirmation_error = @user.errors.full_messages_for(:password_confirmation).first %>

    <div class="space-y-2" data-field="user[name]">
      <%= form.label :name, class: "block text-sm font-medium text-slate-700" %>
      <% classes = [
        "w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white",
        ("border-rose-400 bg-rose-50/60 focus:border-rose-500 focus:ring-rose-400" if name_error.present?)
      ].compact.join(" ") %>
      <%= form.text_field :name, class: classes, autocomplete: "name" %>
      <% if name_error.present? %>
        <p class="form-field-error text-xs font-medium text-rose-600"><%= name_error %></p>
      <% end %>
    </div>

    <div class="space-y-2" data-field="user[email]">
      <%= form.label :email, class: "block text-sm font-medium text-slate-700" %>
      <% classes = [
        "w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white",
        ("border-rose-400 bg-rose-50/60 focus:border-rose-500 focus:ring-rose-400" if email_error.present?)
      ].compact.join(" ") %>
      <%= form.email_field :email, class: classes, autocomplete: "email" %>
      <% if email_error.present? %>
        <p class="form-field-error text-xs font-medium text-rose-600"><%= email_error %></p>
      <% end %>
    </div>

    <div class="space-y-2" data-field="user[password]">
      <div class="flex items-center justify-between">
        <%= form.label :password, class: "block text-sm font-medium text-slate-700" %>
        <span class="text-xs text-slate-500">Leave blank to keep current password</span>
      </div>
      <% classes = [
        "w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white",
        ("border-rose-400 bg-rose-50/60 focus:border-rose-500 focus:ring-rose-400" if password_error.present?)
      ].compact.join(" ") %>
      <%= form.password_field :password, class: classes, autocomplete: "new-password" %>
      <% if password_error.present? %>
        <p class="form-field-error text-xs font-medium text-rose-600"><%= password_error %></p>
      <% end %>
    </div>

    <div class="space-y-2" data-field="user[password_confirmation]">
      <%= form.label :password_confirmation, class: "block text-sm font-medium text-slate-700" %>
      <% classes = [
        "w-full rounded-xl border border-slate-300 bg-white px-4 py-3 text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white",
        ("border-rose-400 bg-rose-50/60 focus-border-rose-500 focus:ring-rose-400" if password_confirmation_error.present?)
      ].compact.join(" ") %>
      <%= form.password_field :password_confirmation, class: classes, autocomplete: "new-password" %>
      <% if password_confirmation_error.present? %>
        <p class="form-field-error text-xs font-medium text-rose-600"><%= password_confirmation_error %></p>
      <% end %>
    </div>

    <div class="md:col-span-2 flex items-center justify-between text-sm text-slate-600">
      <%= link_to "Back to profile", user_path(@user), class: "text-sm font-medium text-indigo-600 hover:text-indigo-700 underline-offset-4 hover:underline" %>
      <%= form.button "Update user", class: "inline-flex items-center justify-center gap-2 rounded-2xl bg-indigo-600 px-5 py-3 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white" %>
    </div>
  <% end %>
</section>
